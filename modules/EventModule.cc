#include "EventModule.h"

//==============================================================================================================
//
// Event Module
//
//==============================================================================================================

void wvzModule::EventModule::AddOutput()
{
    tx->createBranch<int>("firstgoodvertex");
    tx->createBranch<int>("nvtx");
    tx->createBranch<int>("nTrueInt");
    tx->createBranch<float>("lumi");
    tx->createBranch<float>("puwgt");
    tx->createBranch<float>("puwgt_up");
    tx->createBranch<float>("puwgt_dn");
}

void wvzModule::EventModule::FillOutput()
{
    // First good vertex
    tx->setBranch<int>("firstgoodvertex", firstGoodVertex());

    // Count number of good vertices.
    int nvtx = 0;
    for (unsigned int ivtx = 0; ivtx < cms3.evt_nvtxs(); ivtx++)
    {
        if (!isGoodVertex(ivtx)) { continue; }
        nvtx++;
    }
    tx->setBranch<int>("nvtx", nvtx);

    // N True interaction for pileup reweighting
    if (!cms3.evt_isRealData())
        tx->setBranch<int>("nTrueInt", cms3.puInfo_trueNumInteractions().at(0));
    else
        tx->setBranch<int>("nTrueInt", -999);

    // N True interaction for pileup reweighting
    if (cms3.evt_isRealData())
        tx->setBranch<float>("lumi", 1);
    else if (gconf.year == 2016)
        tx->setBranch<float>("lumi", 35.9);
    else if (gconf.year == 2017)
        tx->setBranch<float>("lumi", 41.3);
    else if (gconf.year == 2018)
        tx->setBranch<float>("lumi", 59.74);

    // puwgt
    if (cms3.evt_isRealData())
        tx->setBranch<float>("puwgt", 1);
    else if (gconf.year == 2016)
        tx->setBranch<float>("puwgt", getTruePUw2016(cms3.puInfo_trueNumInteractions().at(0)));
    else if (gconf.year == 2017)
        tx->setBranch<float>("puwgt", getTruePUw2017(cms3.puInfo_trueNumInteractions().at(0)));
    else if (gconf.year == 2018)
        tx->setBranch<float>("puwgt", getTruePUw2018(cms3.puInfo_trueNumInteractions().at(0)));

    // puwgt
    if (cms3.evt_isRealData())
        tx->setBranch<float>("puwgt_up", 1);
    else if (gconf.year == 2016)
        tx->setBranch<float>("puwgt_up", getTruePUwUp2016(cms3.puInfo_trueNumInteractions().at(0)));
    else if (gconf.year == 2017)
        tx->setBranch<float>("puwgt_up", getTruePUwUp2017(cms3.puInfo_trueNumInteractions().at(0)));
    else if (gconf.year == 2018)
        tx->setBranch<float>("puwgt_up", getTruePUwUp2018(cms3.puInfo_trueNumInteractions().at(0)));

    // puwgt
    if (cms3.evt_isRealData())
        tx->setBranch<float>("puwgt_dn", 1);
    else if (gconf.year == 2016)
        tx->setBranch<float>("puwgt_dn", getTruePUwDn2016(cms3.puInfo_trueNumInteractions().at(0)));
    else if (gconf.year == 2017)
        tx->setBranch<float>("puwgt_dn", getTruePUwDn2016(cms3.puInfo_trueNumInteractions().at(0)));
    else if (gconf.year == 2018)
        tx->setBranch<float>("puwgt_dn", getTruePUwDn2016(cms3.puInfo_trueNumInteractions().at(0)));

    // Some files have wrong xsec / scale1fb so fix it manually (in principle should update scale1fbs.txt but wasn't sure whether it will affect others.)
    float fixXsec = 1;

    const TString& dataset_name = cms3.evt_dataset()[0];

    if (dataset_name.Contains("GluGluHToZZ"))
        fixXsec = 0.01333521/*pb from HXSWG twiki*/ / 0.011814/*pb in scale1fb*/; // Difference between HXSWG and scale1fb

    if (dataset_name.Contains("/ZZTo4L"))
        fixXsec = 1.3816/*pb w/ kfactor*/ / 1.256/*pb w/o kfactor*/; // Missing K-factor

    if (dataset_name.Contains("/TTZToLLNuNu"))
        fixXsec = 0.2728/*pb according to TTZ AN2018-025*/ / 0.2529/*pb what we have*/;

    // These were already set previously but we need to correct for a few samples
    if (fixXsec != 1)
    {
        tx->setBranch<float>("evt_scale1fb", tx->getBranch<float>("evt_scale1fb") * fixXsec);
        tx->setBranch<float>("xsec_br", tx->getBranch<float>("xsec_br") * fixXsec);
    }

}

float getTruePUw2016(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.366077;
   if (nvtx>=1.000000 && nvtx<2.000000) return 0.893925;
   if (nvtx>=2.000000 && nvtx<3.000000) return 1.197716;
   if (nvtx>=3.000000 && nvtx<4.000000) return 0.962699;
   if (nvtx>=4.000000 && nvtx<5.000000) return 1.120976;
   if (nvtx>=5.000000 && nvtx<6.000000) return 1.164859;
   if (nvtx>=6.000000 && nvtx<7.000000) return 0.795599;
   if (nvtx>=7.000000 && nvtx<8.000000) return 0.495824;
   if (nvtx>=8.000000 && nvtx<9.000000) return 0.742182;
   if (nvtx>=9.000000 && nvtx<10.000000) return 0.878856;
   if (nvtx>=10.000000 && nvtx<11.000000) return 0.964232;
   if (nvtx>=11.000000 && nvtx<12.000000) return 1.072499;
   if (nvtx>=12.000000 && nvtx<13.000000) return 1.125335;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.176027;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.202083;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.207643;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.200176;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.182682;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.143998;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.096632;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.065602;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.051166;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.051600;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.050630;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.049862;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.058173;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.072155;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.083030;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.095693;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.107871;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.094621;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.082620;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.041247;
   if (nvtx>=33.000000 && nvtx<34.000000) return 0.985752;
   if (nvtx>=34.000000 && nvtx<35.000000) return 0.910807;
   if (nvtx>=35.000000 && nvtx<36.000000) return 0.820923;
   if (nvtx>=36.000000 && nvtx<37.000000) return 0.716787;
   if (nvtx>=37.000000 && nvtx<38.000000) return 0.610013;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.503118;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.404841;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.309195;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.227920;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.163690;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.113180;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.077300;
   if (nvtx>=45.000000 && nvtx<46.000000) return 0.050922;
   if (nvtx>=46.000000 && nvtx<47.000000) return 0.031894;
   if (nvtx>=47.000000 && nvtx<48.000000) return 0.020094;
   if (nvtx>=48.000000 && nvtx<49.000000) return 0.012263;
   if (nvtx>=49.000000 && nvtx<50.000000) return 0.007426;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.004380;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.002608;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.001566;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.000971;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.000729;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.000673;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.000730;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.000949;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.001355;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.001894;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.003082;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.004097;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.004874;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.005256;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.005785;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.005515;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.005000;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.004410;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.004012;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.003548;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.003108;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.002702;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.002337;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.002025;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.001723;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.000000;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.000000;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.000000;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.000000;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.000000;
   return 0.;
}

float getTruePUwUp2016(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.356011;
   if (nvtx>=1.000000 && nvtx<2.000000) return 0.690003;
   if (nvtx>=2.000000 && nvtx<3.000000) return 1.127090;
   if (nvtx>=3.000000 && nvtx<4.000000) return 0.836982;
   if (nvtx>=4.000000 && nvtx<5.000000) return 1.011672;
   if (nvtx>=5.000000 && nvtx<6.000000) return 1.039095;
   if (nvtx>=6.000000 && nvtx<7.000000) return 0.720703;
   if (nvtx>=7.000000 && nvtx<8.000000) return 0.339115;
   if (nvtx>=8.000000 && nvtx<9.000000) return 0.483342;
   if (nvtx>=9.000000 && nvtx<10.000000) return 0.584547;
   if (nvtx>=10.000000 && nvtx<11.000000) return 0.610261;
   if (nvtx>=11.000000 && nvtx<12.000000) return 0.708232;
   if (nvtx>=12.000000 && nvtx<13.000000) return 0.805109;
   if (nvtx>=13.000000 && nvtx<14.000000) return 0.891936;
   if (nvtx>=14.000000 && nvtx<15.000000) return 0.941170;
   if (nvtx>=15.000000 && nvtx<16.000000) return 0.970850;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.009165;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.041019;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.042397;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.020997;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.000466;
   if (nvtx>=21.000000 && nvtx<22.000000) return 0.993241;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.010937;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.035254;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.057806;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.086859;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.123708;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.160085;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.199686;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.240943;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.258119;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.282543;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.276707;
   if (nvtx>=33.000000 && nvtx<34.000000) return 1.254458;
   if (nvtx>=34.000000 && nvtx<35.000000) return 1.204819;
   if (nvtx>=35.000000 && nvtx<36.000000) return 1.129953;
   if (nvtx>=36.000000 && nvtx<37.000000) return 1.028372;
   if (nvtx>=37.000000 && nvtx<38.000000) return 0.915364;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.794263;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.677935;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.554631;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.442505;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.347456;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.265129;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.201535;
   if (nvtx>=45.000000 && nvtx<46.000000) return 0.148880;
   if (nvtx>=46.000000 && nvtx<47.000000) return 0.105273;
   if (nvtx>=47.000000 && nvtx<48.000000) return 0.075319;
   if (nvtx>=48.000000 && nvtx<49.000000) return 0.052453;
   if (nvtx>=49.000000 && nvtx<50.000000) return 0.036361;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.024546;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.016603;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.011065;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.007185;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.005012;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.003594;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.002586;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.002150;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.002173;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.002494;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.003733;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.004849;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.005798;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.006355;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.007145;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.006974;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.006483;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.005867;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.005482;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.004980;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.004486;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.004013;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.003573;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.003190;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.002798;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.000000;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.000000;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.000000;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.000000;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.000000;
   return 0.;
}

float getTruePUwDn2016(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.380675;
   if (nvtx>=1.000000 && nvtx<2.000000) return 1.164965;
   if (nvtx>=2.000000 && nvtx<3.000000) return 1.265627;
   if (nvtx>=3.000000 && nvtx<4.000000) return 1.111375;
   if (nvtx>=4.000000 && nvtx<5.000000) return 1.262993;
   if (nvtx>=5.000000 && nvtx<6.000000) return 1.290999;
   if (nvtx>=6.000000 && nvtx<7.000000) return 0.936149;
   if (nvtx>=7.000000 && nvtx<8.000000) return 0.798689;
   if (nvtx>=8.000000 && nvtx<9.000000) return 1.130589;
   if (nvtx>=9.000000 && nvtx<10.000000) return 1.390219;
   if (nvtx>=10.000000 && nvtx<11.000000) return 1.542416;
   if (nvtx>=11.000000 && nvtx<12.000000) return 1.574103;
   if (nvtx>=12.000000 && nvtx<13.000000) return 1.534121;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.532817;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.525233;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.464280;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.381714;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.308356;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.234372;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.171836;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.130193;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.092821;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.063882;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.037924;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.015380;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.000200;
   if (nvtx>=26.000000 && nvtx<27.000000) return 0.989182;
   if (nvtx>=27.000000 && nvtx<28.000000) return 0.975134;
   if (nvtx>=28.000000 && nvtx<29.000000) return 0.960878;
   if (nvtx>=29.000000 && nvtx<30.000000) return 0.942058;
   if (nvtx>=30.000000 && nvtx<31.000000) return 0.897851;
   if (nvtx>=31.000000 && nvtx<32.000000) return 0.853186;
   if (nvtx>=32.000000 && nvtx<33.000000) return 0.786621;
   if (nvtx>=33.000000 && nvtx<34.000000) return 0.712954;
   if (nvtx>=34.000000 && nvtx<35.000000) return 0.629623;
   if (nvtx>=35.000000 && nvtx<36.000000) return 0.540522;
   if (nvtx>=36.000000 && nvtx<37.000000) return 0.446713;
   if (nvtx>=37.000000 && nvtx<38.000000) return 0.356539;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.272696;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.201062;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.139073;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.091848;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.058531;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.035602;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.021229;
   if (nvtx>=45.000000 && nvtx<46.000000) return 0.012131;
   if (nvtx>=46.000000 && nvtx<47.000000) return 0.006557;
   if (nvtx>=47.000000 && nvtx<48.000000) return 0.003557;
   if (nvtx>=48.000000 && nvtx<49.000000) return 0.001875;
   if (nvtx>=49.000000 && nvtx<50.000000) return 0.000997;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.000541;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.000330;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.000244;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.000228;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.000280;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.000389;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.000536;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.000772;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.001134;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.001577;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.002519;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.003268;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.003788;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.003972;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.004248;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.003932;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.003459;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.002957;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.002606;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.002230;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.001890;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.001589;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.001327;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.001110;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.000911;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.000000;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.000000;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.000000;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.000000;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.000000;
   return 0.;
}

float getTruePUw2017(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.183454;
   if (nvtx>=1.000000 && nvtx<2.000000) return 3.933129;
   if (nvtx>=2.000000 && nvtx<3.000000) return 3.471107;
   if (nvtx>=3.000000 && nvtx<4.000000) return 2.492398;
   if (nvtx>=4.000000 && nvtx<5.000000) return 1.624947;
   if (nvtx>=5.000000 && nvtx<6.000000) return 1.515094;
   if (nvtx>=6.000000 && nvtx<7.000000) return 1.287910;
   if (nvtx>=7.000000 && nvtx<8.000000) return 1.278245;
   if (nvtx>=8.000000 && nvtx<9.000000) return 0.615844;
   if (nvtx>=9.000000 && nvtx<10.000000) return 1.452074;
   if (nvtx>=10.000000 && nvtx<11.000000) return 1.497679;
   if (nvtx>=11.000000 && nvtx<12.000000) return 1.487471;
   if (nvtx>=12.000000 && nvtx<13.000000) return 1.331159;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.164494;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.079013;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.054366;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.080654;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.129065;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.165837;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.189361;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.212844;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.238493;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.259673;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.270985;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.272699;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.271303;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.270874;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.266523;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.274487;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.251627;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.221309;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.169537;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.109031;
   if (nvtx>=33.000000 && nvtx<34.000000) return 1.038162;
   if (nvtx>=34.000000 && nvtx<35.000000) return 0.969431;
   if (nvtx>=35.000000 && nvtx<36.000000) return 0.911879;
   if (nvtx>=36.000000 && nvtx<37.000000) return 0.866810;
   if (nvtx>=37.000000 && nvtx<38.000000) return 0.834505;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.788378;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.750795;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.759151;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.793175;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.858347;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.958794;
   if (nvtx>=44.000000 && nvtx<45.000000) return 1.094321;
   if (nvtx>=45.000000 && nvtx<46.000000) return 1.255635;
   if (nvtx>=46.000000 && nvtx<47.000000) return 1.419644;
   if (nvtx>=47.000000 && nvtx<48.000000) return 1.495932;
   if (nvtx>=48.000000 && nvtx<49.000000) return 1.530537;
   if (nvtx>=49.000000 && nvtx<50.000000) return 1.462202;
   if (nvtx>=50.000000 && nvtx<51.000000) return 1.336754;
   if (nvtx>=51.000000 && nvtx<52.000000) return 1.154386;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.950555;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.749701;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.569788;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.410747;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.290007;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.198654;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.137644;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.096639;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.069231;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.050859;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.038443;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.029959;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.024095;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.017120;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.012480;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.010768;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.009597;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.008812;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.008310;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.008018;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.007885;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.007875;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.006337;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.005334;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.005444;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.005584;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.005744;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.005916;
   if (nvtx>=80.000000 && nvtx<81.000000) return 0.006090;
   if (nvtx>=81.000000 && nvtx<82.000000) return 0.006257;
   if (nvtx>=82.000000 && nvtx<83.000000) return 0.006408;
   if (nvtx>=83.000000 && nvtx<84.000000) return 0.005095;
   if (nvtx>=84.000000 && nvtx<85.000000) return 0.004228;
   if (nvtx>=85.000000 && nvtx<86.000000) return 0.004259;
   if (nvtx>=86.000000 && nvtx<87.000000) return 0.004266;
   if (nvtx>=87.000000 && nvtx<88.000000) return 0.004247;
   if (nvtx>=88.000000 && nvtx<89.000000) return 0.004203;
   if (nvtx>=89.000000 && nvtx<90.000000) return 0.004137;
   return 0.;
}

float getTruePUwUp2017(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.177286;
   if (nvtx>=1.000000 && nvtx<2.000000) return 3.346173;
   if (nvtx>=2.000000 && nvtx<3.000000) return 2.807417;
   if (nvtx>=3.000000 && nvtx<4.000000) return 2.503082;
   if (nvtx>=4.000000 && nvtx<5.000000) return 1.381285;
   if (nvtx>=5.000000 && nvtx<6.000000) return 1.328334;
   if (nvtx>=6.000000 && nvtx<7.000000) return 1.239856;
   if (nvtx>=7.000000 && nvtx<8.000000) return 1.162085;
   if (nvtx>=8.000000 && nvtx<9.000000) return 0.489529;
   if (nvtx>=9.000000 && nvtx<10.000000) return 0.908092;
   if (nvtx>=10.000000 && nvtx<11.000000) return 1.037592;
   if (nvtx>=11.000000 && nvtx<12.000000) return 1.003538;
   if (nvtx>=12.000000 && nvtx<13.000000) return 0.985724;
   if (nvtx>=13.000000 && nvtx<14.000000) return 0.882452;
   if (nvtx>=14.000000 && nvtx<15.000000) return 0.809757;
   if (nvtx>=15.000000 && nvtx<16.000000) return 0.779626;
   if (nvtx>=16.000000 && nvtx<17.000000) return 0.793283;
   if (nvtx>=17.000000 && nvtx<18.000000) return 0.849755;
   if (nvtx>=18.000000 && nvtx<19.000000) return 0.916293;
   if (nvtx>=19.000000 && nvtx<20.000000) return 0.970145;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.020233;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.072573;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.117483;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.146041;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.156881;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.158537;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.164143;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.174624;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.203714;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.207656;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.204557;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.177953;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.140645;
   if (nvtx>=33.000000 && nvtx<34.000000) return 1.091877;
   if (nvtx>=34.000000 && nvtx<35.000000) return 1.042795;
   if (nvtx>=35.000000 && nvtx<36.000000) return 1.000013;
   if (nvtx>=36.000000 && nvtx<37.000000) return 0.963827;
   if (nvtx>=37.000000 && nvtx<38.000000) return 0.935734;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.886822;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.840849;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.836170;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.845490;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.872007;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.920800;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.997406;
   if (nvtx>=45.000000 && nvtx<46.000000) return 1.104557;
   if (nvtx>=46.000000 && nvtx<47.000000) return 1.237577;
   if (nvtx>=47.000000 && nvtx<48.000000) return 1.332409;
   if (nvtx>=48.000000 && nvtx<49.000000) return 1.434612;
   if (nvtx>=49.000000 && nvtx<50.000000) return 1.479502;
   if (nvtx>=50.000000 && nvtx<51.000000) return 1.489928;
   if (nvtx>=51.000000 && nvtx<52.000000) return 1.437915;
   if (nvtx>=52.000000 && nvtx<53.000000) return 1.335038;
   if (nvtx>=53.000000 && nvtx<54.000000) return 1.192483;
   if (nvtx>=54.000000 && nvtx<55.000000) return 1.026864;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.836024;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.662582;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.505286;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.386044;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.295818;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.228925;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.179856;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.144000;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.117756;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.098442;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.072006;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.053502;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.046597;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.041540;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.037871;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.035281;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.033560;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.032570;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.032212;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.025809;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.021764;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.022404;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.023325;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.024498;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.025892;
   if (nvtx>=80.000000 && nvtx<81.000000) return 0.027474;
   if (nvtx>=81.000000 && nvtx<82.000000) return 0.029211;
   if (nvtx>=82.000000 && nvtx<83.000000) return 0.031067;
   if (nvtx>=83.000000 && nvtx<84.000000) return 0.025729;
   if (nvtx>=84.000000 && nvtx<85.000000) return 0.022307;
   if (nvtx>=85.000000 && nvtx<86.000000) return 0.023539;
   if (nvtx>=86.000000 && nvtx<87.000000) return 0.024757;
   if (nvtx>=87.000000 && nvtx<88.000000) return 0.025946;
   if (nvtx>=88.000000 && nvtx<89.000000) return 0.027096;
   if (nvtx>=89.000000 && nvtx<90.000000) return 0.028203;
   return 0.;
}

float getTruePUwDn2017(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.192765;
   if (nvtx>=1.000000 && nvtx<2.000000) return 4.383619;
   if (nvtx>=2.000000 && nvtx<3.000000) return 4.634526;
   if (nvtx>=3.000000 && nvtx<4.000000) return 2.401455;
   if (nvtx>=4.000000 && nvtx<5.000000) return 1.895853;
   if (nvtx>=5.000000 && nvtx<6.000000) return 1.703668;
   if (nvtx>=6.000000 && nvtx<7.000000) return 1.349956;
   if (nvtx>=7.000000 && nvtx<8.000000) return 1.448618;
   if (nvtx>=8.000000 && nvtx<9.000000) return 0.924199;
   if (nvtx>=9.000000 && nvtx<10.000000) return 2.229088;
   if (nvtx>=10.000000 && nvtx<11.000000) return 2.263182;
   if (nvtx>=11.000000 && nvtx<12.000000) return 2.122160;
   if (nvtx>=12.000000 && nvtx<13.000000) return 1.781904;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.569264;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.475780;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.459846;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.465519;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.461025;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.446825;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.426419;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.408771;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.401750;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.401920;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.404058;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.402043;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.389515;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.366832;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.332842;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.309176;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.255485;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.197287;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.119331;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.035108;
   if (nvtx>=33.000000 && nvtx<34.000000) return 0.947184;
   if (nvtx>=34.000000 && nvtx<35.000000) return 0.869651;
   if (nvtx>=35.000000 && nvtx<36.000000) return 0.809509;
   if (nvtx>=36.000000 && nvtx<37.000000) return 0.766106;
   if (nvtx>=37.000000 && nvtx<38.000000) return 0.740459;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.712046;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.703123;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.750147;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.833883;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.953773;
   if (nvtx>=43.000000 && nvtx<44.000000) return 1.101705;
   if (nvtx>=44.000000 && nvtx<45.000000) return 1.259120;
   if (nvtx>=45.000000 && nvtx<46.000000) return 1.396223;
   if (nvtx>=46.000000 && nvtx<47.000000) return 1.476304;
   if (nvtx>=47.000000 && nvtx<48.000000) return 1.415617;
   if (nvtx>=48.000000 && nvtx<49.000000) return 1.291282;
   if (nvtx>=49.000000 && nvtx<50.000000) return 1.085007;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.865995;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.651367;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.468211;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.324342;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.218464;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.141093;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.090307;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.056753;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.036499;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.024053;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.016352;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.011525;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.008453;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.006466;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.005162;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.003677;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.002708;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.002371;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.002146;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.001996;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.001896;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.001830;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.001787;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.001758;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.001385;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.001134;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.001120;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.001106;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.001091;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.001074;
   if (nvtx>=80.000000 && nvtx<81.000000) return 0.001053;
   if (nvtx>=81.000000 && nvtx<82.000000) return 0.001028;
   if (nvtx>=82.000000 && nvtx<83.000000) return 0.000996;
   if (nvtx>=83.000000 && nvtx<84.000000) return 0.000748;
   if (nvtx>=84.000000 && nvtx<85.000000) return 0.000585;
   if (nvtx>=85.000000 && nvtx<86.000000) return 0.000553;
   if (nvtx>=86.000000 && nvtx<87.000000) return 0.000519;
   if (nvtx>=87.000000 && nvtx<88.000000) return 0.000483;
   if (nvtx>=88.000000 && nvtx<89.000000) return 0.000446;
   if (nvtx>=89.000000 && nvtx<90.000000) return 0.000409;
   return 0.;
}

// Derived wrt 2018 MC
float getTruePUw2018(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.;
   if (nvtx>=1.000000 && nvtx<2.000000) return 10.;
   if (nvtx>=2.000000 && nvtx<3.000000) return 10.;
   if (nvtx>=3.000000 && nvtx<4.000000) return 10.;
   if (nvtx>=4.000000 && nvtx<5.000000) return 10.;
   if (nvtx>=5.000000 && nvtx<6.000000) return 8.856287;
   if (nvtx>=6.000000 && nvtx<7.000000) return 6.426556;
   if (nvtx>=7.000000 && nvtx<8.000000) return 4.756865;
   if (nvtx>=8.000000 && nvtx<9.000000) return 3.536773;
   if (nvtx>=9.000000 && nvtx<10.000000) return 2.680621;
   if (nvtx>=10.000000 && nvtx<11.000000) return 2.146159;
   if (nvtx>=11.000000 && nvtx<12.000000) return 1.824576;
   if (nvtx>=12.000000 && nvtx<13.000000) return 1.630471;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.512244;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.442750;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.407974;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.398108;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.404069;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.416739;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.427277;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.428110;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.414450;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.385493;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.344411;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.296857;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.248764;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.204756;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.167562;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.138131;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.116129;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.100449;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.089689;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.082455;
   if (nvtx>=33.000000 && nvtx<34.000000) return 1.077453;
   if (nvtx>=34.000000 && nvtx<35.000000) return 1.073395;
   if (nvtx>=35.000000 && nvtx<36.000000) return 1.068879;
   if (nvtx>=36.000000 && nvtx<37.000000) return 1.062303;
   if (nvtx>=37.000000 && nvtx<38.000000) return 1.051912;
   if (nvtx>=38.000000 && nvtx<39.000000) return 1.035951;
   if (nvtx>=39.000000 && nvtx<40.000000) return 1.012879;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.981588;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.941575;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.893023;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.836804;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.774409;
   if (nvtx>=45.000000 && nvtx<46.000000) return 0.707803;
   if (nvtx>=46.000000 && nvtx<47.000000) return 0.639192;
   if (nvtx>=47.000000 && nvtx<48.000000) return 0.570787;
   if (nvtx>=48.000000 && nvtx<49.000000) return 0.504608;
   if (nvtx>=49.000000 && nvtx<50.000000) return 0.442319;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.385128;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.333765;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.288511;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.249271;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.215667;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.187139;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.163041;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.142704;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.125488;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.110812;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.098171;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.087147;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.077406;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.068698;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.060846;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.053733;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.047284;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.041453;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.036208;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.031523;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.027367;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.023706;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.020499;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.017701;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.015266;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.013148;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.011305;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.009696;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.008288;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.007049;
   if (nvtx>=80.000000 && nvtx<81.000000) return 0.005956;
   if (nvtx>=81.000000 && nvtx<82.000000) return 0.004987;
   if (nvtx>=82.000000 && nvtx<83.000000) return 0.004128;
   if (nvtx>=83.000000 && nvtx<84.000000) return 0.003364;
   if (nvtx>=84.000000 && nvtx<85.000000) return 0.002687;
   if (nvtx>=85.000000 && nvtx<86.000000) return 0.002091;
   if (nvtx>=86.000000 && nvtx<87.000000) return 0.001576;
   if (nvtx>=87.000000 && nvtx<88.000000) return 0.001141;
   if (nvtx>=88.000000 && nvtx<89.000000) return 0.000789;
   if (nvtx>=89.000000 && nvtx<90.000000) return 0.000518;
   if (nvtx>=90.000000 && nvtx<91.000000) return 0.000328;
   if (nvtx>=91.000000 && nvtx<92.000000) return 0.000199;
   if (nvtx>=92.000000 && nvtx<93.000000) return 0.000115;
   if (nvtx>=93.000000 && nvtx<94.000000) return 0.000065;
   if (nvtx>=94.000000 && nvtx<95.000000) return 0.000035;
   if (nvtx>=95.000000 && nvtx<96.000000) return 0.000019;
   if (nvtx>=96.000000 && nvtx<97.000000) return 0.000010;
   if (nvtx>=97.000000 && nvtx<98.000000) return 0.000005;
   if (nvtx>=98.000000 && nvtx<99.000000) return 0.000002;
   if (nvtx>=99.000000 && nvtx<100.000000) return 0.000001;
   return 0.;
}
float getTruePUwUp2018(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.;
   if (nvtx>=1.000000 && nvtx<2.000000) return 10.;
   if (nvtx>=2.000000 && nvtx<3.000000) return 10.;
   if (nvtx>=3.000000 && nvtx<4.000000) return 10.;
   if (nvtx>=4.000000 && nvtx<5.000000) return 10.;
   if (nvtx>=5.000000 && nvtx<6.000000) return 7.583666;
   if (nvtx>=6.000000 && nvtx<7.000000) return 5.432223;
   if (nvtx>=7.000000 && nvtx<8.000000) return 3.969606;
   if (nvtx>=8.000000 && nvtx<9.000000) return 2.938890;
   if (nvtx>=9.000000 && nvtx<10.000000) return 2.203116;
   if (nvtx>=10.000000 && nvtx<11.000000) return 1.728863;
   if (nvtx>=11.000000 && nvtx<12.000000) return 1.445054;
   if (nvtx>=12.000000 && nvtx<13.000000) return 1.277583;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.179929;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.125121;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.099574;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.095759;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.107794;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.129799;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.155527;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.178631;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.193461;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.196177;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.185671;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.163819;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.134695;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.103039;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.072979;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.047382;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.027774;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.014565;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.007406;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.005510;
   if (nvtx>=33.000000 && nvtx<34.000000) return 1.007940;
   if (nvtx>=34.000000 && nvtx<35.000000) return 1.013755;
   if (nvtx>=35.000000 && nvtx<36.000000) return 1.022023;
   if (nvtx>=36.000000 && nvtx<37.000000) return 1.031725;
   if (nvtx>=37.000000 && nvtx<38.000000) return 1.041668;
   if (nvtx>=38.000000 && nvtx<39.000000) return 1.050415;
   if (nvtx>=39.000000 && nvtx<40.000000) return 1.056326;
   if (nvtx>=40.000000 && nvtx<41.000000) return 1.057678;
   if (nvtx>=41.000000 && nvtx<42.000000) return 1.052847;
   if (nvtx>=42.000000 && nvtx<43.000000) return 1.040486;
   if (nvtx>=43.000000 && nvtx<44.000000) return 1.019689;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.990124;
   if (nvtx>=45.000000 && nvtx<46.000000) return 0.952092;
   if (nvtx>=46.000000 && nvtx<47.000000) return 0.906458;
   if (nvtx>=47.000000 && nvtx<48.000000) return 0.854563;
   if (nvtx>=48.000000 && nvtx<49.000000) return 0.798084;
   if (nvtx>=49.000000 && nvtx<50.000000) return 0.738871;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.678788;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.619570;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.562680;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.509238;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.459992;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.415341;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.375389;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.340010;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.308914;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.281694;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.257873;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.236941;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.218398;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.201778;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.186683;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.172790;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.159858;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.147720;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.136278;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.125479;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.115303;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.105742;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.096796;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.088456;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.080706;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.073519;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.066859;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.060679;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.054928;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.049550;
   if (nvtx>=80.000000 && nvtx<81.000000) return 0.044484;
   if (nvtx>=81.000000 && nvtx<82.000000) return 0.039673;
   if (nvtx>=82.000000 && nvtx<83.000000) return 0.035062;
   if (nvtx>=83.000000 && nvtx<84.000000) return 0.030602;
   if (nvtx>=84.000000 && nvtx<85.000000) return 0.026261;
   if (nvtx>=85.000000 && nvtx<86.000000) return 0.022034;
   if (nvtx>=86.000000 && nvtx<87.000000) return 0.017956;
   if (nvtx>=87.000000 && nvtx<88.000000) return 0.014108;
   if (nvtx>=88.000000 && nvtx<89.000000) return 0.010615;
   if (nvtx>=89.000000 && nvtx<90.000000) return 0.007609;
   if (nvtx>=90.000000 && nvtx<91.000000) return 0.005280;
   if (nvtx>=91.000000 && nvtx<92.000000) return 0.003510;
   if (nvtx>=92.000000 && nvtx<93.000000) return 0.002245;
   if (nvtx>=93.000000 && nvtx<94.000000) return 0.001388;
   if (nvtx>=94.000000 && nvtx<95.000000) return 0.000834;
   if (nvtx>=95.000000 && nvtx<96.000000) return 0.000489;
   if (nvtx>=96.000000 && nvtx<97.000000) return 0.000282;
   if (nvtx>=97.000000 && nvtx<98.000000) return 0.000160;
   if (nvtx>=98.000000 && nvtx<99.000000) return 0.000089;
   if (nvtx>=99.000000 && nvtx<100.000000) return 0.000049;
   return 0.;
}
float getTruePUwDn2018(int nvtx) {
   if (nvtx>=0.000000 && nvtx<1.000000) return 0.;
   if (nvtx>=1.000000 && nvtx<2.000000) return 10.;
   if (nvtx>=2.000000 && nvtx<3.000000) return 10.;
   if (nvtx>=3.000000 && nvtx<4.000000) return 10.;
   if (nvtx>=4.000000 && nvtx<5.000000) return 10.;
   if (nvtx>=5.000000 && nvtx<6.000000) return 10.;
   if (nvtx>=6.000000 && nvtx<7.000000) return 7.709734;
   if (nvtx>=7.000000 && nvtx<8.000000) return 5.766704;
   if (nvtx>=8.000000 && nvtx<9.000000) return 4.311357;
   if (nvtx>=9.000000 && nvtx<10.000000) return 3.328081;
   if (nvtx>=10.000000 && nvtx<11.000000) return 2.721994;
   if (nvtx>=11.000000 && nvtx<12.000000) return 2.349104;
   if (nvtx>=12.000000 && nvtx<13.000000) return 2.114335;
   if (nvtx>=13.000000 && nvtx<14.000000) return 1.964202;
   if (nvtx>=14.000000 && nvtx<15.000000) return 1.872008;
   if (nvtx>=15.000000 && nvtx<16.000000) return 1.820821;
   if (nvtx>=16.000000 && nvtx<17.000000) return 1.796002;
   if (nvtx>=17.000000 && nvtx<18.000000) return 1.783536;
   if (nvtx>=18.000000 && nvtx<19.000000) return 1.770484;
   if (nvtx>=19.000000 && nvtx<20.000000) return 1.746376;
   if (nvtx>=20.000000 && nvtx<21.000000) return 1.705162;
   if (nvtx>=21.000000 && nvtx<22.000000) return 1.646685;
   if (nvtx>=22.000000 && nvtx<23.000000) return 1.576237;
   if (nvtx>=23.000000 && nvtx<24.000000) return 1.501792;
   if (nvtx>=24.000000 && nvtx<25.000000) return 1.430738;
   if (nvtx>=25.000000 && nvtx<26.000000) return 1.368005;
   if (nvtx>=26.000000 && nvtx<27.000000) return 1.315733;
   if (nvtx>=27.000000 && nvtx<28.000000) return 1.273792;
   if (nvtx>=28.000000 && nvtx<29.000000) return 1.240646;
   if (nvtx>=29.000000 && nvtx<30.000000) return 1.214126;
   if (nvtx>=30.000000 && nvtx<31.000000) return 1.192041;
   if (nvtx>=31.000000 && nvtx<32.000000) return 1.172453;
   if (nvtx>=32.000000 && nvtx<33.000000) return 1.153631;
   if (nvtx>=33.000000 && nvtx<34.000000) return 1.133866;
   if (nvtx>=34.000000 && nvtx<35.000000) return 1.111334;
   if (nvtx>=35.000000 && nvtx<36.000000) return 1.084117;
   if (nvtx>=36.000000 && nvtx<37.000000) return 1.050411;
   if (nvtx>=37.000000 && nvtx<38.000000) return 1.008800;
   if (nvtx>=38.000000 && nvtx<39.000000) return 0.958513;
   if (nvtx>=39.000000 && nvtx<40.000000) return 0.899579;
   if (nvtx>=40.000000 && nvtx<41.000000) return 0.832868;
   if (nvtx>=41.000000 && nvtx<42.000000) return 0.760010;
   if (nvtx>=42.000000 && nvtx<43.000000) return 0.683198;
   if (nvtx>=43.000000 && nvtx<44.000000) return 0.604953;
   if (nvtx>=44.000000 && nvtx<45.000000) return 0.527852;
   if (nvtx>=45.000000 && nvtx<46.000000) return 0.454260;
   if (nvtx>=46.000000 && nvtx<47.000000) return 0.386098;
   if (nvtx>=47.000000 && nvtx<48.000000) return 0.324694;
   if (nvtx>=48.000000 && nvtx<49.000000) return 0.270754;
   if (nvtx>=49.000000 && nvtx<50.000000) return 0.224414;
   if (nvtx>=50.000000 && nvtx<51.000000) return 0.185357;
   if (nvtx>=51.000000 && nvtx<52.000000) return 0.152948;
   if (nvtx>=52.000000 && nvtx<53.000000) return 0.126371;
   if (nvtx>=53.000000 && nvtx<54.000000) return 0.104746;
   if (nvtx>=54.000000 && nvtx<55.000000) return 0.087208;
   if (nvtx>=55.000000 && nvtx<56.000000) return 0.072969;
   if (nvtx>=56.000000 && nvtx<57.000000) return 0.061351;
   if (nvtx>=57.000000 && nvtx<58.000000) return 0.051791;
   if (nvtx>=58.000000 && nvtx<59.000000) return 0.043841;
   if (nvtx>=59.000000 && nvtx<60.000000) return 0.037157;
   if (nvtx>=60.000000 && nvtx<61.000000) return 0.031478;
   if (nvtx>=61.000000 && nvtx<62.000000) return 0.026616;
   if (nvtx>=62.000000 && nvtx<63.000000) return 0.022430;
   if (nvtx>=63.000000 && nvtx<64.000000) return 0.018823;
   if (nvtx>=64.000000 && nvtx<65.000000) return 0.015719;
   if (nvtx>=65.000000 && nvtx<66.000000) return 0.013061;
   if (nvtx>=66.000000 && nvtx<67.000000) return 0.010799;
   if (nvtx>=67.000000 && nvtx<68.000000) return 0.008890;
   if (nvtx>=68.000000 && nvtx<69.000000) return 0.007291;
   if (nvtx>=69.000000 && nvtx<70.000000) return 0.005961;
   if (nvtx>=70.000000 && nvtx<71.000000) return 0.004862;
   if (nvtx>=71.000000 && nvtx<72.000000) return 0.003959;
   if (nvtx>=72.000000 && nvtx<73.000000) return 0.003217;
   if (nvtx>=73.000000 && nvtx<74.000000) return 0.002610;
   if (nvtx>=74.000000 && nvtx<75.000000) return 0.002113;
   if (nvtx>=75.000000 && nvtx<76.000000) return 0.001706;
   if (nvtx>=76.000000 && nvtx<77.000000) return 0.001372;
   if (nvtx>=77.000000 && nvtx<78.000000) return 0.001098;
   if (nvtx>=78.000000 && nvtx<79.000000) return 0.000873;
   if (nvtx>=79.000000 && nvtx<80.000000) return 0.000688;
   if (nvtx>=80.000000 && nvtx<81.000000) return 0.000537;
   if (nvtx>=81.000000 && nvtx<82.000000) return 0.000413;
   if (nvtx>=82.000000 && nvtx<83.000000) return 0.000314;
   if (nvtx>=83.000000 && nvtx<84.000000) return 0.000233;
   if (nvtx>=84.000000 && nvtx<85.000000) return 0.000169;
   if (nvtx>=85.000000 && nvtx<86.000000) return 0.000120;
   if (nvtx>=86.000000 && nvtx<87.000000) return 0.000081;
   if (nvtx>=87.000000 && nvtx<88.000000) return 0.000053;
   if (nvtx>=88.000000 && nvtx<89.000000) return 0.000033;
   if (nvtx>=89.000000 && nvtx<90.000000) return 0.000019;
   if (nvtx>=90.000000 && nvtx<91.000000) return 0.000011;
   if (nvtx>=91.000000 && nvtx<92.000000) return 0.000006;
   if (nvtx>=92.000000 && nvtx<93.000000) return 0.000003;
   if (nvtx>=93.000000 && nvtx<94.000000) return 0.000001;
   if (nvtx>=94.000000 && nvtx<95.000000) return 0.000001;
   if (nvtx>=95.000000 && nvtx<96.000000) return 0.000000;
   if (nvtx>=96.000000 && nvtx<97.000000) return 0.000000;
   if (nvtx>=97.000000 && nvtx<98.000000) return 0.000000;
   if (nvtx>=98.000000 && nvtx<99.000000) return 0.000000;
   if (nvtx>=99.000000 && nvtx<100.000000) return 0.000000;
   return 0.;
}
